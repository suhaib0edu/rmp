
# RMP - Restaurant Management Platform

RMP هو تطبيق متكامل لإدارة المطاعم تم تطويره باستخدام Flutter، وهو مصمم ليكون نظام نقاط بيع (POS) يعمل بكفاءة عالية مع دعم كامل للعمل دون اتصال بالإنترنت. يتيح التطبيق إدارة الطلبات، المنتجات، الفواتير، والعمليات الإدارية الأخرى، مع الاعتماد على قاعدة بيانات محلية سريعة ومزامنتها مع خادم خلفي.

## ✨ الميزات

-   **العمل دون اتصال (Offline-First)**: تم تصميم التطبيق ليعمل بكفاءة كاملة دون الحاجة لاتصال دائم بالإنترنت، حيث يتم تخزين جميع البيانات محليًا أولاً.
-   **إدارة الطلبات**: إنشاء وإدارة الطلبات بسهولة، مع التمييز بين الطلبات المحلية وطلبات التوصيل.
-   **إدارة المنتجات والأصناف**: واجهات سهلة لإضافة وتعديل وحذف المنتجات وتصنيفها ضمن مجموعات (أصناف).
-   **إنشاء الفواتير وطباعتها**: إنشاء فواتير ديناميكية بتنسيقات متعددة (فاتورة لكل منتج، فاتورة لكل مجموعة، فاتورة شاملة) وتجهيزها للطباعة كملفات PDF.
-   **سجل الفواتير والتقارير**: عرض تقارير مفصلة عن المبيعات اليومية، الشهرية، والسنوية.
-   **المصادقة والتسجيل الآمن**: تسجيل الدخول باستخدام حساب Google، مع إدارة آمنة للمستخدمين والجلسات.
-   **لوحة تحكم إدارية**: واجهة مخصصة للمديرين تتيح لهم التحكم الكامل في المنتجات، الأصناف، سجل الفواتير، وإدارة الاشتراكات.
-   **إدارة الفروع**: دعم إدارة فروع متعددة للمطعم من حساب مدير واحد.

## 🛠️ التقنيات المستخدمة (Tech Stack)

-   **إطار العمل (Framework)**: [Flutter](https://flutter.dev/)
-   **إدارة الحالة (State Management)**: [GetX](https://pub.dev/packages/get) - لإدارة الحالة، حقن التبعيات (Dependency Injection)، وإدارة المسارات.
-   **قاعدة البيانات المحلية (Local Database)**: [ObjectBox](https://objectbox.io/) - قاعدة بيانات NoSQL عالية الأداء وموجهة للكائنات (Object-oriented) تدعم بنية Offline-First.
-   **التواصل مع الخادم (Networking)**: [GraphQL](https://graphql.org/) مع مكتبة `graphql_flutter` لإجراء عمليات الاستعلام والتعديل (Queries & Mutations).
-   **المصادقة (Authentication)**: [Firebase Authentication](https://firebase.google.com/products/auth) و `google_sign_in` لتسجيل الدخول عبر Google.
-   **إنشاء ملفات PDF**: مكتبة `pdf` لإنشاء فواتير ديناميكية.
-   **إدارة الأذونات**: مكتبة `permission_handler` لطلب أذونات التخزين.
-   **معلومات الجهاز**: مكتبة `device_info_plus` للحصول على تفاصيل الجهاز لأغراض الأمان.

## 🏛️ البنية المعمارية وهيكل الملفات

يتبع المشروع بنية معمارية نظيفة تركز على فصل الاهتمامات (Separation of Concerns)، مع بنية ملفات منظمة على النحو التالي:

```
lib/
├── pages/
│   ├── auth/             # صفحات المصادقة وإدارة المطاعم
│   │   └── restaurant_list/
│   │       ├── start/      # الصفحة الرئيسية بعد تسجيل الدخول
│   │       │   ├── control_panel/  # لوحة التحكم الإدارية
│   │       │   └── select_order/   # صفحات إنشاء الطلبات
│   └── ...
│
├── services/
│   ├── local/            # خدمات قاعدة البيانات المحلية
│   │   ├── models.dart     # نماذج بيانات ObjectBox
│   │   └── object_box.dart # إعداد وتهيئة ObjectBox
│   ├── server/           # خدمات التواصل مع الخادم
│   │   └── graphql/      # إعداد عميل GraphQL والعمليات
│   └── utils.dart        # دوال مساعدة عامة
│
├── widgets/              # مكونات واجهة المستخدم القابلة لإعادة الاستخدام
│   ├── w_items/          # مكونات معقدة مثل الفواتير والقوائم
│   └── ...               # مكونات أساسية (Suh... widgets)
│
├── models/
│   └── models.dart       # نماذج بيانات لفك ترميز استجابات GraphQL
│
├── objectbox-model.json  # تعريف مخطط قاعدة بيانات ObjectBox
├── objectbox.g.dart      # الكود المُولّد تلقائيًا لـ ObjectBox
└── main.dart             # نقطة انطلاق التطبيق والتهيئة الأولية
```

-   **بنية Offline-First**: يتم تنفيذ جميع عمليات CRUD (إنشاء، قراءة، تحديث، حذف) على قاعدة بيانات ObjectBox المحلية أولاً، مما يضمن استجابة فورية للتطبيق. يتم لاحقًا مزامنة هذه البيانات مع الخادم الخلفي.
-   **فصل المنطق عن العرض**: يتم فصل منطق الأعمال في ملفات `_ctr.dart` (Controllers)، بينما تظل واجهات المستخدم في ملفات `_page.dart` أو `_ad.dart`.

## 🚀 التثبيت والإعداد (Installation & Setup)

لتشغيل هذا المشروع على جهازك المحلي، اتبع الخطوات التالية:

**المتطلبات الأساسية:**
-   تثبيت Flutter SDK (إصدار 3.x أو أحدث).
-   بيئة تطوير متكاملة (IDE) مثل Android Studio أو VS Code.

1.  **استنساخ المستودع:**
    ```sh
    git clone https://github.com/suhaib0edu/rmp.git
    cd RMP
    ```

2.  **تثبيت الاعتماديات:**
    ```sh
    flutter pub get
    ```

3.  **توليد ملفات ObjectBox:**
    من الضروري تشغيل هذا الأمر في كل مرة يتم فيها تعديل نماذج البيانات في `lib/services/local/models.dart`.
    ```sh
    flutter pub run build_runner build
    ```

4.  **إعداد Firebase:**
    -   قم بإنشاء مشروع جديد على [Firebase Console](https://console.firebase.google.com/).
    -   اتبع تعليمات إضافة Flutter إلى مشروعك.
    -   قم بتنزيل ملف `google-services.json` (للأندرويد) و `GoogleService-Info.plist` (لـ iOS) وأضفها إلى مشروعك.
    -   استبدل محتوى ملف `lib/firebase_options.dart` بالملف الذي تم إنشاؤه بواسطة FlutterFire CLI.

5.  **تكوين نقطة النهاية (Endpoint) لـ GraphQL:**
    -   افتح ملف `lib/services/server/graphql/graphql.dart`.
    -   قم بتعديل متغير `httpLink` ليشير إلى عنوان URL الخاص بخادم GraphQL الخاص بك.

6.  **تشغيل التطبيق:**
    ```sh
    flutter run
    ```

## ✅ جودة الكود والممارسات المتبعة

-   **الكود النظيف**: تم تنظيم الكود بطريقة وحداتية (modular) لتعزيز قابلية القراءة والصيانة.
-   **مكونات قابلة لإعادة الاستخدام**: تم بناء مكتبة مخصصة من واجهات المستخدم (`Suh...` widgets) لضمان اتساق التصميم وتقليل تكرار الكود.
-   **معالجة الأخطاء**: يتم تسجيل الأخطاء ومعالجتها بشكل منهجي، خاصة تلك المتعلقة بقاعدة البيانات المحلية والاتصال بالشبكة.
-   **البيانات المهيكلة**: استخدام نماذج بيانات (Data Models) قوية سواء لقاعدة البيانات المحلية (ObjectBox) أو لاستجابات الخادم (GraphQL).

## 🗺️ التحسينات المستقبلية / خارطة الطريق

-   **المزامنة التلقائية في الخلفية**: تطبيق خدمة تعمل في الخلفية لمزامنة البيانات المحلية مع الخادم بشكل دوري وتلقائي.
-   **إدارة الأدوار والصلاحيات**: تطوير نظام صلاحيات متكامل للمستخدمين (مدير، محاسب، إلخ).
-   **تحسينات على التقارير**: إضافة رسوم بيانية ولوحات معلومات (Dashboards) لتحليل أعمق للبيانات.
-   **دعم الطابعات الحرارية**: دمج SDKs للطباعة مباشرة على طابعات الفواتير الحرارية عبر البلوتوث أو الشبكة.
-   **كتابة الاختبارات (Tests)**: إضافة اختبارات الوحدة (Unit Tests) واختبارات الواجهة الرسومية (Widget Tests) لضمان استقرار التطبيق.

## 🤝 إرشادات المساهمة (Contributing Guidelines)

نرحب بالمساهمات! إذا كنت ترغب في المساهمة، يرجى اتباع الخطوات التالية:

1.  قم بعمل **Fork** للمستودع.
2.  أنشئ فرعًا جديدًا لميزتك أو إصلاح الخلل (`git checkout -b feature/new-feature`).
3.  قم بإجراء التغييرات الخاصة بك وقم بعمل commit مع رسائل واضحة.
4.  ادفع تغييراتك إلى المستودع الخاص بك (`git push origin feature/new-feature`).
5.  افتح **طلب سحب (Pull Request)**.

## 📜 الترخيص (License)

هذا المشروع مرخص بموجب رخصة **Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International**.

هذا يعني أنه يمكنك:
-   **المشاركة**: نسخ وتوزيع المواد بأي وسيلة أو شكل.
-   **التكييف**: تعديل المواد والبناء عليها.

بموجب الشروط التالية:
-   **الإسناد (Attribution)**: يجب عليك نسب العمل لصاحبه الأصلي.
-   **غير التجاري (NonCommercial)**: لا يمكنك استخدام هذا العمل لأغراض تجارية.
-   **المشاركة بالمثل (ShareAlike)**: إذا قمت بتعديل العمل، يجب عليك توزيع مساهماتك بنفس الترخيص.

يمكنك قراءة [النص الكامل للترخيص هنا](https://creativecommons.org/licenses/by-nc-sa/4.0/).
